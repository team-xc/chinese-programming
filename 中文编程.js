/*
 MIT License
 Copyright (c) 2022 Boy
*/

const УёџТюг = `
ТѕЉТюЅСИђСИфтГЌугдСИ▓сђї­ЪљћсђЇ№╝їуГЅС║јРђютЮцтЮцРЮц№ИЈРђЮсђѓ
ТѕЉТюЅСИђСИфтГЌугдСИ▓сђї­ЪЈђсђЇ№╝їуГЅС║јРђюТЅЊу»«уљЃРђЮсђѓ

УЙЊтЄ║№╝џРђюТѕЉтЈФРђЮсђї­ЪљћсђЇРђю№╝їТѕЉС╝џРђЮсђї­ЪЈђсђЇРђюсђѓРђЮсђѓ
`;

(function (УёџТюг) {
    const УЙЊтЁЦТхЂ = УёџТюг => {
        let СйЇуй« = 0, УАї = 1, тѕЌ = 0;

        const СИІСИфтГЌугд = () => {
            const тГЌугд = УёџТюг.charAt(СйЇуй«++);
            if (тГЌугд === '\n') {
                УАї++;
                тѕЌ = 0;
            } else тѕЌ++;
            return тГЌугд;
        };

        const УДѓТхІ = () => УёџТюг.charAt(СйЇуй«);

        const у╗ЊТЮЪ = () => СйЇуй« >= УёџТюг.length;

        const т╝ѓтИИ = С┐АТЂ» => {
            throw new Error(`${С┐АТЂ»} ${УАї}:${тѕЌ}`);
        };

        return {СИІСИфтГЌугд, УДѓТхІ, у╗ЊТЮЪ, т╝ѓтИИ};
    };

    const С╗цуЅїТхЂ = УЙЊтЁЦТхЂ => {
        const тЁ│жћ«У»Ї = /(ТѕЉ|ТюЅ|СИђ|СИф)/i;
        const у▒╗тъІ = /(ТЋ┤|ТЋ░|тГЌ|угд|СИ▓)/i;
        const уЕ║уЎйтГЌугд = /(№╝ї| |\t|\n)/i;
        const ТЋ┤ТЋ░ = /[0-9СИђС║їСИЅтЏЏС║ћтЁГСИЃтЁФС╣ЮтЇЂтБ╣У┤░тЈЂУѓєС╝ЇжЎєТЪњТЇїујќТІЙ]/i;
        const тЈўжЄЈ = /(?!ТѕЉ|ТюЅ|СИђ|СИф)[\u4e00-\u9fa5]/i;
        const ТаЄуѓ╣угдтЈи = /(сђѓ|№╝џ|сђї|сђЇ)/i;
        const У┐љу«Ќугд = /(уГЅ|С║ј)/i;
        let тйЊтЅЇ = null;

        const Тў»тљд = {
            тЁ│жћ«У»Ї: тГЌугд => тЁ│жћ«У»Ї.test(тГЌугд),
            у▒╗тъІ: тГЌугд => у▒╗тъІ.test(тГЌугд),
            уЕ║уЎйтГЌугд: тГЌугд => уЕ║уЎйтГЌугд.test(тГЌугд),
            ТЋ┤ТЋ░: тГЌугд => ТЋ┤ТЋ░.test(тГЌугд),
            тЈўжЄЈ: тГЌугд => тЈўжЄЈ.test(тГЌугд),
            ТаЄуѓ╣угдтЈи: тГЌугд => ТаЄуѓ╣угдтЈи.test(тГЌугд),
            У┐љу«Ќугд: тГЌугд => У┐љу«Ќугд.test(тГЌугд)
        };

        const Уи│У┐Є = {
            ТЅ╣Т│е: () => {
                У»╗тЈќ.ТюЪжЌ┤(тГЌугд => тГЌугд !== '\n');
                УЙЊтЁЦТхЂ.СИІСИфтГЌугд();
            }
        };

        const С╗цуЅї = {
            тЁ│жћ«У»Ї: тђ╝ => ({у▒╗тъІ: 'тЁ│жћ«У»Ї', тђ╝}),
            тГЌугдСИ▓: тђ╝ => ({у▒╗тъІ: 'тГЌугдСИ▓', тђ╝}),
            ТЋ┤ТЋ░: тђ╝ => ({у▒╗тъІ: 'ТЋ┤ТЋ░', тђ╝}),
            у▒╗тъІ: тђ╝ => ({у▒╗тъІ: 'у▒╗тъІ', тђ╝}),
            тЈўжЄЈ: тљЇуД░ => ({у▒╗тъІ: 'тЈўжЄЈ', тљЇуД░}),
            ТаЄуѓ╣угдтЈи: тђ╝ => ({у▒╗тъІ: 'ТаЄуѓ╣угдтЈи', тђ╝}),
            У┐љу«Ќугд: тђ╝ => ({у▒╗тъІ: 'У┐љу«Ќугд', тђ╝})
        };

        const У»╗тЈќ = {
            СИІСИфС╗цуЅї: () => {
                У»╗тЈќ.ТюЪжЌ┤(Тў»тљд.уЕ║уЎйтГЌугд);
                if (УЙЊтЁЦТхЂ.у╗ЊТЮЪ()) return null;
                const тГЌугд = УЙЊтЁЦТхЂ.УДѓТхІ();

                switch (тГЌугд) {
                    case '~': {
                        Уи│У┐Є.ТЅ╣Т│е();
                        return У»╗тЈќ.СИІСИфС╗цуЅї();
                    }
                    case 'Рђю': {
                        return У»╗тЈќ.тГЌугдСИ▓();
                    }
                    case 'сђї': {
                        return У»╗тЈќ.т╝ЋућетЈўжЄЈ();
                    }
                }

                if (Тў»тљд.У┐љу«Ќугд(тГЌугд)) return С╗цуЅї.У┐љу«Ќугд(У»╗тЈќ.ТюЪжЌ┤(Тў»тљд.У┐љу«Ќугд));
                if (Тў»тљд.тЁ│жћ«У»Ї(тГЌугд)) return С╗цуЅї.тЁ│жћ«У»Ї(У»╗тЈќ.ТюЪжЌ┤(Тў»тљд.тЁ│жћ«У»Ї));
                if (Тў»тљд.у▒╗тъІ(тГЌугд)) return С╗цуЅї.у▒╗тъІ(У»╗тЈќ.ТюЪжЌ┤(Тў»тљд.у▒╗тъІ));
                if (Тў»тљд.ТЋ┤ТЋ░(тГЌугд)) return У»╗тЈќ.ТЋ┤ТЋ░();
                if (Тў»тљд.тЈўжЄЈ(тГЌугд)) return У»╗тЈќ.тЈўжЄЈ();
                if (Тў»тљд.ТаЄуѓ╣угдтЈи(тГЌугд)) return С╗цуЅї.ТаЄуѓ╣угдтЈи(УЙЊтЁЦТхЂ.СИІСИфтГЌугд());

                УЙЊтЁЦТхЂ.т╝ѓтИИ(`ТёЈтцќуџёС╗цуЅї сђї${тГЌугд}сђЇ`);
            },
            ТюЪжЌ┤: ТќГУеђ => {
                let тГЌугд = '';
                while (!УЙЊтЁЦТхЂ.у╗ЊТЮЪ() && ТќГУеђ(УЙЊтЁЦТхЂ.УДѓТхІ()))
                    тГЌугд += УЙЊтЁЦТхЂ.СИІСИфтГЌугд();
                return тГЌугд;
            },
            ТЇЋТЇЅ: у╗ЊТЮЪтГЌугд => {
                let ти▓ТЇЋТЇЅ = false, ТЇЋТЇЅтГЌугд = '';
                УЙЊтЁЦТхЂ.СИІСИфтГЌугд();
                while (!УЙЊтЁЦТхЂ.у╗ЊТЮЪ()) {
                    const тГЌугд = УЙЊтЁЦТхЂ.СИІСИфтГЌугд();
                    if (ти▓ТЇЋТЇЅ) {
                        ТЇЋТЇЅтГЌугд += тГЌугд;
                        ти▓ТЇЋТЇЅ = false;
                    } else if (тГЌугд === '\\') {
                        ти▓ТЇЋТЇЅ = true;
                    } else if (тГЌугд === у╗ЊТЮЪтГЌугд) {
                        break;
                    } else {
                        ТЇЋТЇЅтГЌугд += тГЌугд;
                    }
                }
                return ТЇЋТЇЅтГЌугд;
            },
            т╝ЋућетЈўжЄЈ: () => С╗цуЅї.тЈўжЄЈ(У»╗тЈќ.ТЇЋТЇЅ('сђЇ')),
            тЈўжЄЈ: () => С╗цуЅї.тЈўжЄЈ(У»╗тЈќ.ТюЪжЌ┤(Тў»тљд.тЈўжЄЈ)),
            тГЌугдСИ▓: () => С╗цуЅї.тГЌугдСИ▓(У»╗тЈќ.ТЇЋТЇЅ('РђЮ')),
            ТЋ┤ТЋ░: () => С╗цуЅї.ТЋ┤ТЋ░(У»╗тЈќ.ТюЪжЌ┤(Тў»тљд.ТЋ┤ТЋ░))
        };

        const УДѓТхІ = () => тйЊтЅЇ || (тйЊтЅЇ = У»╗тЈќ.СИІСИфС╗цуЅї());

        const СИІСИфС╗цуЅї = () => {
            const С╗цуЅї = тйЊтЅЇ;
            тйЊтЅЇ = null;
            return С╗цуЅї || У»╗тЈќ.СИІСИфС╗цуЅї();
        };

        const у╗ЊТЮЪ = () => УДѓТхІ() == null;

        return {СИІСИфС╗цуЅї, УДѓТхІ, у╗ЊТЮЪ, Тў»тљдтї╣жЁЇ: Тў»тљд, т╝ѓтИИ: УЙЊтЁЦТхЂ.т╝ѓтИИ};
    };

    const УДБТъљ = С╗цуЅїТхЂ => {
        const С╗цуЅї = {
            уеІт║Ј: уеІт║ЈСйЊ => ({
                'у▒╗тъІ': 'уеІт║Ј',
                'ТЈЈУ┐░': {
                    'уеІт║ЈСйЊ': уеІт║ЈСйЊ
                }
            }),
            тБ░ТўјтЈўжЄЈ: (тљЇуД░, у▒╗тъІ, тђ╝) => ({
                'у▒╗тъІ': 'тБ░ТўјтЈўжЄЈ',
                'ТЈЈУ┐░': {
                    'тљЇуД░': тљЇуД░,
                    'у▒╗тъІ': у▒╗тъІ,
                    'тђ╝': тђ╝
                }
            }),
            У░ЃућеУАеУЙЙт╝Ј: (тљЇуД░, тЈѓТЋ░) => ({
                'у▒╗тъІ': 'У░ЃућеУАеУЙЙт╝Ј',
                'ТЈЈУ┐░': {
                    'У░Ѓуће': тљЇуД░,
                    'тЈѓТЋ░': тЈѓТЋ░
                }
            }),
            УјитЈќтЈўжЄЈ: тљЇуД░ => ({
                'у▒╗тъІ': 'УјитЈќтЈўжЄЈ',
                'ТЈЈУ┐░': {
                    'тљЇуД░': тљЇуД░
                }
            }),
            тГЌугдСИ▓: тђ╝ => ({
                'у▒╗тъІ': 'тГЌугдСИ▓',
                'ТЈЈУ┐░': {
                    'тђ╝': тђ╝
                }
            }),
        };

        const Тў»тљд = {
            ТаЄуѓ╣угдтЈи: тГЌугд => {
                const С╗цуЅї = С╗цуЅїТхЂ.УДѓТхІ();
                return С╗цуЅї && С╗цуЅї.у▒╗тъІ === 'ТаЄуѓ╣угдтЈи' && (!тГЌугд || С╗цуЅї.тђ╝ === тГЌугд) && С╗цуЅї;
            },
            у▒╗тъІ: тГЌугд => {
                const С╗цуЅї = С╗цуЅїТхЂ.УДѓТхІ();
                return С╗цуЅї && С╗цуЅї.у▒╗тъІ === 'у▒╗тъІ' && (!тГЌугд || С╗цуЅї.тђ╝ === тГЌугд) && С╗цуЅї;
            },
            тЁ│жћ«У»Ї: тЁ│жћ«У»Ї => {
                const С╗цуЅї = С╗цуЅїТхЂ.УДѓТхІ();
                return С╗цуЅї && С╗цуЅї.у▒╗тъІ === 'тЁ│жћ«У»Ї' && (!тЁ│жћ«У»Ї || С╗цуЅї.тђ╝ === тЁ│жћ«У»Ї) && С╗цуЅї;
            },
            У┐љу«Ќугд: У┐љу«Ќугд => {
                const С╗цуЅї = С╗цуЅїТхЂ.УДѓТхІ();
                return С╗цуЅї && С╗цуЅї.у▒╗тъІ === 'У┐љу«Ќугд' && (!У┐љу«Ќугд || С╗цуЅї.тђ╝ === У┐љу«Ќугд) && С╗цуЅї;
            }
        };

        const Уи│У┐Є = {
            ТаЄуѓ╣угдтЈи: тГЌугд => {
                if (Тў»тљд.ТаЄуѓ╣угдтЈи(тГЌугд)) С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                else С╗цуЅїТхЂ.т╝ѓтИИ(`ТюЪТюЏТаЄуѓ╣угдтЈи сђї${тГЌугд}сђЇ`);
            },
            у▒╗тъІ: тГЌугд => {
                if (Тў»тљд.у▒╗тъІ(тГЌугд)) С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                else С╗цуЅїТхЂ.т╝ѓтИИ(`ТюЪТюЏу▒╗тъІ сђї${тГЌугд}сђЇ`);
            }
        };

        const ТѕќУ«И = {
            У░Ѓуће: УАеУЙЙт╝Ј => УАеУЙЙт╝Ј(),
            тхїтЦЌ: (тйЊтЅЇУіѓуѓ╣, уѕХУіѓуѓ╣) => тйЊтЅЇУіѓуѓ╣
        };

        const У»ГТ│ЋтѕєТъљ = {
            жАХт▒ѓ: () => {
                const У»ГТ│ЋТаЉ = Array();
                while (!С╗цуЅїТхЂ.у╗ЊТЮЪ()) {
                    У»ГТ│ЋТаЉ.push(У»ГТ│ЋтѕєТъљ.УАеУЙЙт╝Ј());
                }
                return С╗цуЅї.уеІт║Ј(У»ГТ│ЋТаЉ);
            },
            УАеУЙЙт╝Ј: () => ТѕќУ«И.У░Ѓуће(() => ТѕќУ«И.тхїтЦЌ(У»ГТ│ЋтѕєТъљ.тјЪтГљ(), 0)),
            тјЪтГљ: () => ТѕќУ«И.У░Ѓуће(() => {
                if (Тў»тљд.ТаЄуѓ╣угдтЈи('сђѓ')) С╗цуЅїТхЂ.СИІСИфС╗цуЅї();

                if (Тў»тљд.тЁ│жћ«У»Ї('ТѕЉТюЅСИђСИф') && С╗цуЅїТхЂ.СИІСИфС╗цуЅї()) {
                    const у▒╗тъІС╗цуЅї = С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                    const тЈўжЄЈС╗цуЅї = С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                    const У┐љу«ЌугдС╗цуЅї = С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                    const С╗цуЅї = С╗цуЅїТхЂ.СИІСИфС╗цуЅї();

                    if (у▒╗тъІС╗цуЅї.у▒╗тъІ === 'у▒╗тъІ' &&
                        тЈўжЄЈС╗цуЅї.у▒╗тъІ === 'тЈўжЄЈ' &&
                        У┐љу«ЌугдС╗цуЅї.у▒╗тъІ === 'У┐љу«Ќугд' &&
                        У┐љу«ЌугдС╗цуЅї.тђ╝ === 'уГЅС║ј' &&
                        (С╗цуЅї.у▒╗тъІ === 'ТЋ┤ТЋ░' || С╗цуЅї.у▒╗тъІ === 'тГЌугдСИ▓')
                    ) return У»ГТ│ЋтѕєТъљ.тБ░ТўјтЈўжЄЈ(тЈўжЄЈС╗цуЅї.тљЇуД░, у▒╗тъІС╗цуЅї.тђ╝, С╗цуЅї.тђ╝);
                }

                const С╗цуЅї = С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                if (С╗цуЅї.у▒╗тъІ === 'тЈўжЄЈ') {
                    const тљЇуД░ = С╗цуЅї.тљЇуД░;
                    const тЈѓТЋ░ = Array();
                    const ТаЄуѓ╣угдтЈиС╗цуЅї = С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                    if (ТаЄуѓ╣угдтЈиС╗цуЅї.тђ╝ === '№╝џ') {
                        while (!Тў»тљд.ТаЄуѓ╣угдтЈи('сђѓ')) {
                            const С╗цуЅї = С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                            if (С╗цуЅї === null) {
                                Уи│У┐Є.ТаЄуѓ╣угдтЈи('сђѓ');
                                break;
                            }
                            switch (С╗цуЅї.у▒╗тъІ) {
                                case 'тЈўжЄЈ':
                                    тЈѓТЋ░.push(У»ГТ│ЋтѕєТъљ.УјитЈќтЈўжЄЈ(С╗цуЅї.тљЇуД░));
                                    break;
                                case 'тГЌугдСИ▓':
                                    тЈѓТЋ░.push(У»ГТ│ЋтѕєТъљ.тГЌугдСИ▓(С╗цуЅї.тђ╝));
                                    break;
                                default:
                                    У»ГТ│ЋтѕєТъљ.ТёЈтцќ();
                            }
                        }
                        С╗цуЅїТхЂ.СИІСИфС╗цуЅї();
                        return У»ГТ│ЋтѕєТъљ.У░ЃућеУАеУЙЙт╝Ј(тљЇуД░, тЈѓТЋ░);
                    }
                }

                У»ГТ│ЋтѕєТъљ.ТёЈтцќ();
            }),
            УјитЈќтЈўжЄЈ: тљЇуД░ => С╗цуЅї.УјитЈќтЈўжЄЈ(тљЇуД░),
            тГЌугдСИ▓: тђ╝ => С╗цуЅї.тГЌугдСИ▓(тђ╝),
            У░ЃућеУАеУЙЙт╝Ј: (тљЇуД░, тЈѓТЋ░) => С╗цуЅї.У░ЃућеУАеУЙЙт╝Ј(тљЇуД░, тЈѓТЋ░),
            тБ░ТўјтЈўжЄЈ: (тљЇуД░, у▒╗тъІ, тђ╝) => {
                if ((у▒╗тъІ === 'ТЋ┤ТЋ░' && !С╗цуЅїТхЂ.Тў»тљдтї╣жЁЇ.ТЋ┤ТЋ░(тђ╝))) {
                    С╗цуЅїТхЂ.т╝ѓтИИ(`жюђУдЂТЋ┤ТЋ░№╝їСйєтЙЌтѕ░ сђї${тђ╝}сђЇ`);
                }
                if ((у▒╗тъІ === 'тГЌугдСИ▓' && С╗цуЅїТхЂ.Тў»тљдтї╣жЁЇ.ТЋ┤ТЋ░(тђ╝))) {
                    С╗цуЅїТхЂ.т╝ѓтИИ(`жюђУдЂтГЌугдСИ▓№╝їСйєтЙЌтѕ░ сђї${тђ╝}сђЇ`);
                }
                return С╗цуЅї.тБ░ТўјтЈўжЄЈ(тљЇуД░, у▒╗тъІ, тђ╝);
            },
            ТёЈтцќ: () => С╗цуЅїТхЂ.т╝ѓтИИ(`ТёЈтцќуџёС╗цуЅї сђї${С╗цуЅїТхЂ.УДѓТхІ().тђ╝ || С╗цуЅїТхЂ.УДѓТхІ().тљЇуД░ || С╗цуЅїТхЂ.УДѓТхІ().у▒╗тъІ}сђЇ`)
        };

        return У»ГТ│ЋтѕєТъљ.жАХт▒ѓ();
    };

    const ТЅДУАї = (У»ГтЈЦ, уј»тбЃ) => {
        switch (У»ГтЈЦ.у▒╗тъІ) {
            case 'уеІт║Ј':
                let У┐ћтЏътђ╝ = false;
                У»ГтЈЦ.ТЈЈУ┐░.уеІт║ЈСйЊ.forEach(У»ГтЈЦ => {
                    У┐ћтЏътђ╝ = ТЅДУАї(У»ГтЈЦ, уј»тбЃ);
                });
                return У┐ћтЏътђ╝;
            case 'тГЌугдСИ▓':
                return У»ГтЈЦ.ТЈЈУ┐░.тђ╝;
            case 'УјитЈќтЈўжЄЈ':
                return уј»тбЃ.УјитЈќ(У»ГтЈЦ.ТЈЈУ┐░.тљЇуД░);
            case 'тБ░ТўјтЈўжЄЈ':
                return уј»тбЃ.У«Йуй«(У»ГтЈЦ.ТЈЈУ┐░.тљЇуД░, У»ГтЈЦ.ТЈЈУ┐░.тђ╝);
            case 'У░ЃућеУАеУЙЙт╝Ј':
                let тЈѓТЋ░ = String();
                У»ГтЈЦ.ТЈЈУ┐░.тЈѓТЋ░.forEach(тЈѓТЋ░УАеУЙЙт╝Ј => тЈѓТЋ░ += ТЅДУАї(тЈѓТЋ░УАеУЙЙт╝Ј, уј»тбЃ));
                return уј»тбЃ.тЈўжЄЈУАе[У»ГтЈЦ.ТЈЈУ┐░.У░Ѓуће].call(null, тЈѓТЋ░);
            default:
                throw new Error(`ТЌаТ│ЋТЅДУАї сђї${У»ГтЈЦ.у▒╗тъІ}сђЇ`);
        }
    };

    function уј»тбЃ() {
        this.тЈўжЄЈУАе = Object.create(null);
    }

    уј»тбЃ.prototype = {
        УјитЈќ: function (тљЇуД░) {
            if (тљЇуД░ in this.тЈўжЄЈУАе)
                return this.тЈўжЄЈУАе[тљЇуД░] || 'уЕ║';
            throw new Error(`Тюфт«џС╣ЅтЈўжЄЈ сђї${тљЇуД░}сђЇ`);
        },
        У«Йуй«: function (тљЇуД░, тђ╝) {
            return this.тЈўжЄЈУАе[тљЇуД░] = тђ╝;
        }
    };

    const ж╗ўУ«цуј»тбЃ = new уј»тбЃ();

    const тєЁуй«Тќ╣Т│Ћ = {
        УЙЊтЄ║: С┐АТЂ» => {
            console.log(С┐АТЂ» || 'уЕ║');
        }
    };

    for (let Тќ╣Т│Ћ in тєЁуй«Тќ╣Т│Ћ) {
        ж╗ўУ«цуј»тбЃ.У«Йуй«(Тќ╣Т│Ћ, тєЁуй«Тќ╣Т│Ћ[Тќ╣Т│Ћ]);
    }

    ТЅДУАї(УДБТъљ(С╗цуЅїТхЂ(УЙЊтЁЦТхЂ(УёџТюг))), ж╗ўУ«цуј»тбЃ);
})(УёџТюг);